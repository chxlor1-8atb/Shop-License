# üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ (Technical Vulnerability Assessment)

> **‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ:** ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤ (Shop License Management System)  
> **‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:** 12 ‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå 2026  
> **‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:** Cascade AI Security Team  
> **‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï:** Full codebase review (API routes, middleware, authentication, database layer, security utilities)  
> **Framework:** Next.js 14 (App Router) + Neon PostgreSQL + iron-session

---

## üìà ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

| ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç |
|------------------|--------|--------|-------------|
| üî¥ ‡∏ß‡∏¥‡∏Å‡∏§‡∏ï (Critical) | 2 | ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ | P0 |
| üü† ‡∏™‡∏π‡∏á (High) | 5 | ‡πÅ‡∏Å‡πâ‡∏Å‡πà‡∏≠‡∏ô deploy ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ | P1 |
| üü° ‡∏Å‡∏•‡∏≤‡∏á (Medium) | 6 | ‡πÅ‡∏Å‡πâ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô sprint | P2 |
| üîµ ‡∏ï‡πà‡∏≥ (Low) | 5 | ‡πÅ‡∏Å‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ß‡πà‡∏≤‡∏á | P3 |
| **‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î** | **18** | ‚Äî | ‚Äî |

**‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°: 7/10** ‚Äî ‡∏£‡∏∞‡∏ö‡∏ö‡∏°‡∏µ‡∏ê‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏ó‡∏µ‡πà‡∏î‡∏µ ‡πÅ‡∏ï‡πà‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á

---

## üî¥ ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ß‡∏¥‡∏Å‡∏§‡∏ï (Critical Vulnerabilities)

### VULN-01: ‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏î‡∏Å‡∏≤‡∏£ Sanitize ‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå ID ‡πÉ‡∏ô Entities API

**üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:**
- `src/app/api/entities/route.js` ‚Äî ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 17-19 (GET), 93 (PUT), 103 (PUT), 122 (DELETE)

**üîç ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ:**
```javascript
// GET ‚Äî id ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô sanitization
const id = searchParams.get('id');
const entity = await fetchOne('SELECT * FROM entities WHERE id = $1', [id]);

// PUT ‚Äî id ‡∏à‡∏≤‡∏Å body ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô sanitization  
const { id, label, icon, description, display_order, is_active } = body;
await executeQuery('...WHERE id = $6', [..., id]);

// DELETE ‚Äî id ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô sanitization
const id = searchParams.get('id');
await executeQuery('DELETE FROM entities WHERE id = $1', [id]);
```

**‚ö° ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:**
- ‡πÅ‡∏°‡πâ‡πÉ‡∏ä‡πâ parameterized queries ‡πÅ‡∏ï‡πà‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà validate type ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î SQL error ‚Üí Information Disclosure
- ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á negative number ‡∏´‡∏£‡∏∑‡∏≠ `0` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á record ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
- ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö routes ‡∏≠‡∏∑‡πà‡∏ô‡πÜ

**üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```javascript
const id = sanitizeInt(searchParams.get('id'), 0, 1);
if (id < 1) return NextResponse.json({ success: false, message: 'Invalid ID' }, { status: 400 });
```

---

### VULN-02: ‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏î‡∏Å‡∏≤‡∏£ Validate ‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (Date Parameters)

**üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:**
- `src/app/api/licenses/route.js` ‚Äî ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 174, 246 (issue_date, expiry_date)
- `src/app/api/export/route.js` ‚Äî ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 121-122 (expiry_from, expiry_to)
- `src/app/api/export-preview/route.js` ‚Äî ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 100-101
- `src/app/api/activity-logs/route.js` ‚Äî ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 80-81 (date_from, date_to)

**üîç ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ:**
```javascript
// licenses/route.js POST ‚Äî dates ‡∏™‡πà‡∏á‡∏ï‡∏£‡∏á‡∏à‡∏≤‡∏Å body
const { issue_date, expiry_date } = body;
await executeQuery('INSERT INTO licenses ... VALUES ($1,...,$4,$5,...)', 
    [shop_id, ..., issue_date, expiry_date, ...]);

// export/route.js ‚Äî dates ‡∏à‡∏≤‡∏Å query string ‡πÑ‡∏°‡πà validated
const expiry_from = searchParams.get('expiry_from');
const expiry_to = searchParams.get('expiry_to');
whereClauses.push(`l.expiry_date >= $${paramIndex++}`);
params.push(expiry_from); // raw user input
```

**‚ö° ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:**
- Malformed date string ‡∏ó‡∏≥‡πÉ‡∏´‡πâ PostgreSQL error ‚Üí Information Disclosure
- Type confusion attack ‡∏ú‡πà‡∏≤‡∏ô invalid date formats
- ‡πÑ‡∏°‡πà‡∏°‡∏µ range validation ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏™‡∏°‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏°‡∏ú‡∏•

**üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```javascript
function sanitizeDate(value) {
    if (!value) return null;
    const date = new Date(value);
    if (isNaN(date.getTime())) return null;
    return date.toISOString().split('T')[0]; // YYYY-MM-DD format
}
```

---

## üü† ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏π‡∏á (High Vulnerabilities)

### VULN-03: Stored XSS ‡∏ú‡πà‡∏≤‡∏ô Custom Fields

**üìÅ ‡πÑ‡∏ü‡∏•‡πå:** `src/app/api/custom-fields/route.js` ‚Äî ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 69

**üîç ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ:**
```javascript
const { field_name, field_label, ... } = body;
// field_name, field_label ‡∏™‡πà‡∏á‡∏ï‡∏£‡∏á‡∏•‡∏á DB ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô sanitizeString()
await executeQuery('INSERT INTO custom_fields (entity_type, field_name, field_label, ...) VALUES ($1, $2, $3, ...)',
    [entity_type, field_name, field_label, ...]);
```

**‚ö° ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:**
- Admin ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ù‡∏±‡∏á XSS payload ‡∏ú‡πà‡∏≤‡∏ô custom field name
- Payload ‡∏à‡∏∞ render ‡∏ö‡∏ô browser ‡∏Ç‡∏≠‡∏á user ‡∏≠‡∏∑‡πà‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏ô table headers

**üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```javascript
const field_name = sanitizeString(body.field_name || '', 100)
    .replace(/[^a-zA-Z0-9_\u0E00-\u0E7F]/g, '_'); // alphanumeric + Thai + underscore only
const field_label = sanitizeString(body.field_label || '', 255);
```

---

### VULN-04: Rate Limiting ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ö‡∏ô Serverless Environment

**üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:**
- `middleware.js` ‚Äî ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 43-68
- `src/lib/security.js` ‚Äî ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 169-199
- `src/lib/api-helpers.js` ‚Äî ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 242-338

**üîç ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ:**
```javascript
// middleware.js
const ipRequestCounts = new Map(); // ‚Üê resets on cold start

// security.js  
const rateLimitStore = new Map(); // ‚Üê another independent store

// api-helpers.js
const rateLimitMap = new Map(); // ‚Üê yet another independent store
```

**‚ö° ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:**
- Rate limiting ‡πÉ‡∏ä‡πâ in-memory Map ‡∏ã‡∏∂‡πà‡∏á‡πÑ‡∏°‡πà persist ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á serverless cold starts
- ‡πÑ‡∏°‡πà‡∏°‡∏µ protection ‡∏à‡∏£‡∏¥‡∏á‡∏ï‡πà‡∏≠ brute-force attacks
- ‡∏°‡∏µ 3 ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏ã‡πâ‡∏≥‡∏ã‡πâ‡∏≠‡∏ô‡∏Å‡∏±‡∏ô‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏±‡∏ô‡πÑ‡∏´‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á‡∏ö‡∏ô production

**üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
- ‡πÉ‡∏ä‡πâ Vercel KV ‡∏´‡∏£‡∏∑‡∏≠ Upstash Redis ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö distributed rate limiting
- ‡∏£‡∏ß‡∏° 3 ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏õ‡πá‡∏ô 1 ‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏•‡∏≤‡∏á
- ‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÉ‡∏ä‡πâ Edge Middleware + Edge Config

---

### VULN-05: CSP ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï `'unsafe-inline'` ‡πÅ‡∏•‡∏∞ `'unsafe-eval'`

**üìÅ ‡πÑ‡∏ü‡∏•‡πå:** `middleware.js` ‚Äî ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 201, `next.config.js` ‚Äî ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 46-58

**üîç ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ:**
```
script-src 'self' 'unsafe-inline' 'unsafe-eval'
```

**‚ö° ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:**
- CSP ‡πÑ‡∏°‡πà‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô XSS ‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï inline scripts
- Attacker ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ inject JavaScript ‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á

**üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
- ‡πÉ‡∏ä‡πâ nonce-based CSP ‡πÅ‡∏ó‡∏ô `'unsafe-inline'`
- ‡∏•‡∏ö `'unsafe-eval'` ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å Next.js 14 ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ô production

---

### VULN-06: User Full Name ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô Sanitization

**üìÅ ‡πÑ‡∏ü‡∏•‡πå:** `src/app/api/users/route.js` ‚Äî ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 121

**üîç ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ:**
```javascript
const { username, full_name, password, role } = body;
// username ‡∏ú‡πà‡∏≤‡∏ô validateUsername() ‚úì
// password ‡∏ú‡πà‡∏≤‡∏ô validatePassword() ‚úì  
// role ‡∏ú‡πà‡∏≤‡∏ô whitelist check ‚úì
// full_name ‡∏™‡πà‡∏á‡∏ï‡∏£‡∏á ‚úó
const result = await executeQuery(
    'INSERT INTO users (username, full_name, password, role) VALUES ($1, $2, $3, $4)',
    [username, full_name || '', hashedPassword, role]
);
```

**‚ö° ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:**
- Admin ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á user ‡∏ó‡∏µ‡πà‡∏°‡∏µ `full_name` ‡πÄ‡∏õ‡πá‡∏ô XSS payload
- ‡∏Ñ‡πà‡∏≤‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å render ‡πÉ‡∏ô activity logs, dashboard, header ‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡πâ‡∏≤

**üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```javascript
const full_name = sanitizeString(body.full_name || '', 255);
```

---

### VULN-07: Entity Slug ‡πÑ‡∏°‡πà‡∏°‡∏µ Format Validation

**üìÅ ‡πÑ‡∏ü‡∏•‡πå:** `src/app/api/entities/route.js` ‚Äî ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 72

**üîç ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ:**
```javascript
const { slug, label, icon, description, display_order } = body;
// slug ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å validate format ‚Äî ‡∏≠‡∏≤‡∏à‡∏°‡∏µ special characters
await executeQuery('INSERT INTO entities (slug, ...) VALUES ($1, ...)', [slug.toLowerCase(), ...]);
```

**‚ö° ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:**
- ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á entities ‡∏ó‡∏µ‡πà‡∏°‡∏µ slug ‡πÄ‡∏õ‡πá‡∏ô URL-unsafe characters
- ‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÉ‡∏ô routing

**üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```javascript
const slug = body.slug?.toLowerCase().replace(/[^a-z0-9_-]/g, '') || '';
if (!slug || slug.length < 2) return error('Invalid slug format');
```

---

## üü° ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏•‡∏≤‡∏á (Medium Vulnerabilities)

### VULN-08: ‡∏Ç‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô CSRF (Defense-in-Depth)

**üîç ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ:**
- Session cookie ‡∏ï‡∏±‡πâ‡∏á `sameSite: 'strict'` ‡∏ã‡∏∂‡πà‡∏á‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô CSRF ‡πÑ‡∏î‡πâ‡∏î‡∏µ
- ‡πÅ‡∏ï‡πà‡∏Ç‡∏≤‡∏î defense-in-depth mechanisms ‡πÄ‡∏ä‡πà‡∏ô CSRF tokens ‡∏´‡∏£‡∏∑‡∏≠ Origin header validation

**üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
- ‡πÄ‡∏û‡∏¥‡πà‡∏° Origin/Referer header validation ‡πÉ‡∏ô API middleware
- ‡πÄ‡∏û‡∏¥‡πà‡∏° CSRF token ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö critical operations

---

### VULN-09: Migration Route Accessible File System

**üìÅ ‡πÑ‡∏ü‡∏•‡πå:** `src/app/api/migrate/route.js` ‚Äî ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 26-27

**üîç ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ:**
```javascript
const schemaPath = path.join(process.cwd(), 'schema.sql');
const schema = fs.readFileSync(schemaPath, 'utf8');
```

**‚ö° ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:**
- schema.sql ‡∏ñ‡∏π‡∏Å execute ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏µ validation
- ‡∏ñ‡πâ‡∏≤ `ALLOW_MIGRATE=true` ‡∏ñ‡∏π‡∏Å‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏ô production ‚Üí full database destruction

**üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
- ‡πÄ‡∏û‡∏¥‡πà‡∏° checksum verification ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö schema.sql
- ‡∏•‡∏ö route ‡∏ô‡∏µ‡πâ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å production build

---

### VULN-10: ‡πÑ‡∏°‡πà‡∏°‡∏µ Account Lockout Mechanism

**üîç ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ:**
- ‡πÄ‡∏°‡∏∑‡πà‡∏≠ rate limiting ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏ö‡∏ô serverless ‚Üí ‡πÑ‡∏°‡πà‡∏°‡∏µ mechanism ‡∏ó‡∏µ‡πà‡∏à‡∏∞ lock account
- ‡πÑ‡∏°‡πà‡∏°‡∏µ progressive delay ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á failed attempts

**üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
- ‡πÄ‡∏û‡∏¥‡πà‡∏° `failed_login_count` + `locked_until` columns ‡πÉ‡∏ô `users` table
- Lock account ‡∏´‡∏•‡∏±‡∏á 5 failed attempts (auto-unlock ‡∏´‡∏•‡∏±‡∏á 15 ‡∏ô‡∏≤‡∏ó‡∏µ)

---

### VULN-11: Custom Fields JSON ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô Validation

**üìÅ ‡πÑ‡∏ü‡∏•‡πå:** `src/app/api/shops/route.js` ‚Äî ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 100, 115

**üîç ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ:**
```javascript
const { custom_fields } = body;
// custom_fields ‡∏™‡πà‡∏á‡∏ï‡∏£‡∏á‡∏•‡∏á DB ‡πÄ‡∏õ‡πá‡∏ô JSON.stringify() ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà validate structure
await executeQuery('INSERT INTO shops (..., custom_fields) VALUES (..., $7)',
    [..., JSON.stringify(custom_fields || {})]);
```

**‚ö° ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:**
- JSON bomb ‚Üí memory exhaustion
- Extremely large payload ‚Üí disk usage spike

**üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```javascript
const customFieldsStr = JSON.stringify(custom_fields || {});
if (customFieldsStr.length > 10000) { // 10KB limit
    return error('Custom fields too large');
}
```

---

### VULN-12: Error Messages Leak Stack Trace ‡πÉ‡∏ô Preview Deployments

**üìÅ ‡πÑ‡∏ü‡∏•‡πå:** ‡∏ó‡∏∏‡∏Å route ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ `console.error()`

**üîç ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ:**
```javascript
// api-helpers.js
export function safeErrorMessage(error, fallback = '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö') {
    if (process.env.NODE_ENV === 'production') return fallback;
    return typeof error === 'string' ? error : (error?.message || fallback);
}
```

**‚ö° ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:**
- Vercel Preview deployments ‡∏≠‡∏≤‡∏à run ‡πÉ‡∏ô non-production mode
- ‡∏≠‡∏≤‡∏à leak SQL error messages, table names, column names

**üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ `NODE_ENV=production` ‡∏ñ‡∏π‡∏Å‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å Vercel environment
- ‡πÄ‡∏û‡∏¥‡πà‡∏° check: `if (process.env.VERCEL) return fallback;`

---

### VULN-13: Seed Routes Accessible ‡∏ñ‡πâ‡∏≤ `ALLOW_SEED=true`

**üìÅ ‡πÑ‡∏ü‡∏•‡πå:** `src/app/api/seed-shops/route.js`, `src/app/api/seed-custom-fields/route.js`, `src/app/api/seed-10-licenses/route.js`

**üîç ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ:**
- Seed routes ‡∏ñ‡∏π‡∏Å block ‡πÄ‡∏°‡∏∑‡πà‡∏≠ `NODE_ENV=production && ALLOW_SEED !== 'true'`
- ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤ dev ‡∏•‡∏∑‡∏°‡∏•‡∏ö `ALLOW_SEED=true` ‡πÉ‡∏ô Vercel env ‚Üí seed ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÉ‡∏ô production

**üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
- ‡∏•‡∏ö `ALLOW_SEED` env var ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å Vercel production
- ‡πÄ‡∏û‡∏¥‡πà‡∏° double-check: `if (process.env.VERCEL_ENV === 'production') return blocked;`

---

## üîµ ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ï‡πà‡∏≥ (Low Vulnerabilities)

### VULN-14: Session ‡πÑ‡∏°‡πà Invalidate ‡πÄ‡∏°‡∏∑‡πà‡∏≠ User ‡∏ñ‡∏π‡∏Å‡∏•‡∏ö/‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô Role

**üîç ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ:**
- iron-session ‡πÄ‡∏Å‡πá‡∏ö data ‡πÉ‡∏ô encrypted cookie ‚Üí server ‡πÑ‡∏°‡πà‡∏°‡∏µ session store
- Session ‡πÄ‡∏î‡∏¥‡∏°‡∏¢‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏

**üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
- ‡πÄ‡∏û‡∏¥‡πà‡∏° `sessionVersion` ‡πÉ‡∏ô users table
- Periodic re-validation ‡∏ó‡∏∏‡∏Å 5 ‡∏ô‡∏≤‡∏ó‡∏µ

---

### VULN-15: `X-XSS-Protection` Header Deprecated

**üìÅ ‡πÑ‡∏ü‡∏•‡πå:** `src/lib/security.js` ‚Äî ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 159

**üîç ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ:**
```javascript
'X-XSS-Protection': '1; mode=block',
```

**üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
- ‡∏•‡∏ö header ‡∏ô‡∏µ‡πâ‡∏≠‡∏≠‡∏Å ‚Äî ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏î‡πâ‡∏ß‡∏¢ CSP ‡πÅ‡∏ó‡∏ô

---

### VULN-16: Timing Attack ‡∏ö‡∏ô User Enumeration

**üìÅ ‡πÑ‡∏ü‡∏•‡πå:** `src/lib/auth-service.js` ‚Äî ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 20-30

**üîç ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ:**
```javascript
const user = await fetchOne('SELECT * FROM users WHERE username = $1', [username]);
if (!user) throw new Error('‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á'); // ‚Üê returns immediately

const isValid = await bcrypt.compare(password, user.password); // ‚Üê takes ~200ms
```

**üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```javascript
if (!user) {
    await bcrypt.compare(password, '$2a$12$dummy_hash_to_prevent_timing');
    throw new Error('...');
}
```

---

### VULN-17: ‡πÑ‡∏°‡πà‡∏°‡∏µ Request Body Size Limit

**üîç ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ:**
- API routes ‡∏£‡∏±‡∏ö `request.json()` ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ç‡∏ô‡∏≤‡∏î payload
- Vercel ‡∏°‡∏µ default limit 4.5MB ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÉ‡∏´‡∏ç‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö JSON payload

**üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```javascript
const contentLength = parseInt(request.headers.get('content-length') || '0');
if (contentLength > 102400) { // 100KB
    return new NextResponse(JSON.stringify({ error: 'Payload too large' }), { status: 413 });
}
```

---

### VULN-18: Duplicate Rate Limiter Implementations

**üìÅ ‡πÑ‡∏ü‡∏•‡πå:** `middleware.js`, `src/lib/security.js`, `src/lib/api-helpers.js`

**üîç ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ:**
- ‡∏°‡∏µ rate limiter 3 ‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ã‡πâ‡∏≥‡∏ã‡πâ‡∏≠‡∏ô‡∏Å‡∏±‡∏ô
- 2 ‡πÉ‡∏ô 3 ‡πÄ‡∏õ‡πá‡∏ô dead code ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ

**üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
- ‡∏•‡∏ö `isRateLimited()` ‡∏à‡∏≤‡∏Å `security.js`
- ‡∏•‡∏ö `checkRateLimit()` ‡∏à‡∏≤‡∏Å `api-helpers.js`
- ‡πÉ‡∏ä‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ middleware rate limiter

---

## ‚úÖ ‡∏à‡∏∏‡∏î‡πÅ‡∏Ç‡πá‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ (Positive Security Findings)

| ‡∏î‡πâ‡∏≤‡∏ô | ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î |
|------|-----------|
| **Parameterized Queries** | ‡∏ó‡∏∏‡∏Å SQL query ‡πÉ‡∏ä‡πâ `$1, $2` placeholders ‚Äî ‡πÑ‡∏°‡πà‡∏°‡∏µ string concatenation |
| **Password Hashing** | bcrypt with 12 rounds ‚Äî ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏™‡∏π‡∏á |
| **Session Security** | iron-session encrypted cookies + httpOnly + secure + sameSite:strict |
| **Table Name Whitelist** | `db.js` validate table names ‡πÉ‡∏ô dynamic operations |
| **Column Name Validation** | `db.js` ‡πÉ‡∏ä‡πâ regex `^[a-zA-Z_][a-zA-Z0-9_]*$` |
| **Error Sanitization** | Production ‡∏ã‡πà‡∏≠‡∏ô internal errors ‡∏ú‡πà‡∏≤‡∏ô `safeErrorMessage()` |
| **Admin Authorization** | Destructive operations require admin role |
| **CSV Injection Prevention** | Export route sanitize dangerous characters |
| **Cron Authentication** | Timing-safe comparison ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö CRON_SECRET |
| **Audit Trail** | ‡∏ó‡∏∏‡∏Å CRUD operation ‡∏ñ‡∏π‡∏Å log ‡∏û‡∏£‡πâ‡∏≠‡∏° IP + User Agent |
| **WAF Lite** | Middleware block known scanners + suspicious patterns |
| **HSTS** | 2 years + includeSubDomains + preload |
| **Query Timeout** | 30 second timeout protection |

---

## üìã ‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô (Action Plan)

### Priority 0 (‡πÅ‡∏Å‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ - ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 2 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á)
1. **VULN-01:** ‡πÄ‡∏û‡∏¥‡πà‡∏° `sanitizeInt()` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ID parameters ‡πÉ‡∏ô entities API
2. **VULN-02:** ‡πÄ‡∏û‡∏¥‡πà‡∏° `sanitizeDate()` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö date parameters ‡∏ó‡∏∏‡∏Å‡∏ó‡∏µ‡πà

### Priority 1 (‡πÅ‡∏Å‡πâ‡∏Å‡πà‡∏≠‡∏ô deploy ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ - ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 4 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á)
3. **VULN-03:** Sanitize `field_name` ‡πÅ‡∏•‡∏∞ `field_label` ‡πÉ‡∏ô custom fields
4. **VULN-06:** Sanitize `full_name` ‡πÉ‡∏ô users API
5. **VULN-07:** Validate slug format ‡πÉ‡∏ô entities API

### Priority 2 (‡πÅ‡∏Å‡πâ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô sprint - ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 1-2 ‡∏ß‡∏±‡∏ô)
6. **VULN-04:** Implement distributed rate limiting (Vercel KV/Upstash Redis)
7. **VULN-05:** Implement nonce-based CSP
8. **VULN-10:** Add account lockout mechanism
9. **VULN-08:** Add CSRF defense-in-depth
10. **VULN-09:** Secure migration route
11. **VULN-11:** Add JSON size validation
12. **VULN-12:** Fix error leak in preview deployments
13. **VULN-13:** Secure seed routes

### Priority 3 (‡πÅ‡∏Å‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ß‡πà‡∏≤‡∏á - Backlog)
14. **VULN-14:** Session invalidation mechanism
15. **VULN-16:** Fix timing attack
16. **VULN-17:** Add body size limit
17. **VULN-18:** Remove duplicate rate limiters
18. **VULN-15:** Remove deprecated XSS-Protection header

---

## üéØ ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

### ‡∏£‡∏∞‡∏¢‡∏∞‡∏™‡∏±‡πâ‡∏ô (Immediate)
- ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ß‡∏¥‡∏Å‡∏§‡∏ï‡πÅ‡∏•‡∏∞‡∏™‡∏π‡∏á‡∏Å‡πà‡∏≠‡∏ô deploy ‡πÑ‡∏õ production
- ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏î‡πâ‡∏ß‡∏¢ automated security tests
- ‡πÄ‡∏û‡∏¥‡πà‡∏° security headers ‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î‡∏´‡∏≤‡∏¢‡πÑ‡∏õ

### ‡∏£‡∏∞‡∏¢‡∏∞‡∏Å‡∏•‡∏≤‡∏á (Medium-term)
- Implement distributed rate limiting ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö serverless
- Add account lockout ‡πÅ‡∏•‡∏∞ progressive delays
- Implement nonce-based CSP
- Add CSRF protection ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö critical operations

### ‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß (Long-term)
- ‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÉ‡∏ä‡πâ Web Application Firewall (WAF) ‡πÅ‡∏ö‡∏ö‡πÄ‡∏ï‡πá‡∏°‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö
- Implement Security Monitoring ‡πÅ‡∏•‡∏∞ Alerting
- Regular security audits ‡πÅ‡∏•‡∏∞ penetration testing
- Security training ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö development team

---

## üìù ‡∏™‡∏£‡∏∏‡∏õ

‡∏£‡∏∞‡∏ö‡∏ö‡∏°‡∏µ **‡∏ê‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏ó‡∏µ‡πà‡∏î‡∏µ** ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ parameterized queries, encrypted sessions, input sanitization framework, WAF lite, ‡πÅ‡∏•‡∏∞ audit logging ‡∏ó‡∏µ‡πà‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô

**‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:**
1. Input validation ‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡πÉ‡∏ô entities/date parameters
2. Stored XSS vectors ‡∏ú‡πà‡∏≤‡∏ô unsanitized fields  
3. Rate limiting ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ö‡∏ô serverless environment

‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç **Priority 0 + Priority 1** ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô **1-2 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á** ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° sanitization function calls ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö

---

*‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢ Cascade AI Security Team*  
*Last updated: 12 ‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå 2026*

# üîí ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå
# ‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏ó‡∏µ‡πà‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ (Website Security Standard)

**‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£:** ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤ (Shop License Management System)  
**‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô:** 2.0.0  
**‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô:** 16 ‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå 2569  
**‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô:** Cascade AI  
**‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á:** ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏ó‡∏µ‡πà‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ (‡∏™‡∏û‡∏ò‡∏≠./ETDA), OWASP Top 10:2021, ‡∏û.‡∏£.‡∏ö. ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÑ‡∏ã‡πÄ‡∏ö‡∏≠‡∏£‡πå ‡∏û.‡∏®. 2562, ‡∏û.‡∏£.‡∏ö. ‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• (PDPA) ‡∏û.‡∏®. 2562  
**‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï:** ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ã‡∏≠‡∏£‡πå‡∏™‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‚Äî API routes, middleware, authentication, session, database layer, security utilities, frontend

---

## ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô

| ‡∏´‡∏°‡∏ß‡∏î | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î | ‡∏ú‡πà‡∏≤‡∏ô | ‡∏ú‡πà‡∏≤‡∏ô‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô | ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô |
|------|---------------|------|-------------|---------|
| 1. ‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏™‡∏π‡∏à‡∏ô‡πå‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Session | 12 | 11 | 1 | 0 |
| 2. ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á | 6 | 6 | 0 | 0 |
| 3. ‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô Injection | 8 | 8 | 0 | 0 |
| 4. ‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏±‡πà‡∏ß‡πÑ‡∏´‡∏• | 7 | 6 | 1 | 0 |
| 5. Security Headers & Transport | 10 | 10 | 0 | 0 |
| 6. ‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö (Logging) | 5 | 5 | 0 | 0 |
| 7. ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î | 4 | 4 | 0 | 0 |
| 8. ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Configuration | 5 | 4 | 1 | 0 |
| **‡∏£‡∏ß‡∏°** | **57** | **54** | **3** | **0** |

**‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°: 54/57 (94.7%) ‚Äî ‡∏£‡∏∞‡∏î‡∏±‡∏ö: ‡∏î‡∏µ‡∏°‡∏≤‡∏Å**

---

## ‡∏´‡∏°‡∏ß‡∏î‡∏ó‡∏µ‡πà 1: ‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏™‡∏π‡∏à‡∏ô‡πå‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Session (Authentication & Session Management)

### 1.1 ‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (Password Policy)

| ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô |
|-----------|--------|---------|
| ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ ‚â• 8 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `security.js:212` ‚Äî ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö `password.length < 8` |
| ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏´‡∏ç‡πà (A-Z) | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `security.js:226` ‚Äî `/[A-Z]/` |
| ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏•‡πá‡∏Å (a-z) | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `security.js:227` ‚Äî `/[a-z]/` |
| ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç (0-9) | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `security.js:228` ‚Äî `/[0-9]/` |
| ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢ | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `security.js:221` ‚Äî ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö commonPasswords list |
| ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î (‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô DoS) | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `security.js:216` ‚Äî ‚â§ 128 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ |

### 1.2 ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (Password Hashing)

| ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô |
|-----------|--------|---------|
| ‡πÉ‡∏ä‡πâ‡∏≠‡∏±‡∏•‡∏Å‡∏≠‡∏£‡∏¥‡∏ó‡∏∂‡∏°‡∏ó‡∏µ‡πà‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏Å‡∏£‡πà‡∏á (bcrypt/argon2/scrypt) | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `auth-service.js:1` ‚Äî `bcryptjs` |
| Cost factor ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠ (‚â• 10 rounds) | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `auth-service.js:20` ‚Äî DUMMY_HASH ‡πÉ‡∏ä‡πâ `$2a$12$` (12 rounds) |
| Timing-safe comparison ‡πÄ‡∏°‡∏∑‡πà‡∏≠ user ‡πÑ‡∏°‡πà‡∏û‡∏ö | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `auth-service.js:47` ‚Äî ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö DUMMY_HASH ‡πÄ‡∏™‡∏°‡∏≠ |

### 1.3 ‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô Brute Force

| ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô |
|-----------|--------|---------|
| Account lockout ‡∏´‡∏•‡∏±‡∏á‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏° login ‡∏ú‡∏¥‡∏î‡∏ã‡πâ‡∏≥ | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `auth-service.js:17-18` ‚Äî ‡∏•‡πá‡∏≠‡∏Ñ 15 ‡∏ô‡∏≤‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á‡∏ú‡∏¥‡∏î 5 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á |
| Rate limiting ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö login endpoint | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `middleware.js:48,151` ‚Äî 10 req/min ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö login |
| ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° error ‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡πà‡∏≤ username ‡∏´‡∏£‡∏∑‡∏≠ password ‡∏ú‡∏¥‡∏î | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `auth-service.js:49,55` ‚Äî "‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á" |

### 1.4 ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Session

| ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô |
|-----------|--------|---------|
| Session cookie ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™ | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `session.js` ‚Äî iron-session (AES-256-GCM) |
| HttpOnly flag | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `session.js:54` ‚Äî `httpOnly: true` |
| Secure flag (production) | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `session.js:52` ‚Äî `secure: process.env.NODE_ENV === 'production'` |
| SameSite=Strict | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `session.js:56` ‚Äî `sameSite: 'strict'` |
| Session timeout (TTL) | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `session.js:40` ‚Äî 24 ‡∏ä‡∏°. ‡∏õ‡∏Å‡∏ï‡∏¥, 1 ‡∏ä‡∏°. sensitive, 7 ‡∏ß‡∏±‡∏ô remember me |
| Session validity check (server-side) | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `session.js:97-108` ‚Äî `isSessionValid()` ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö loginTime + TTL |
| Periodic DB re-validation | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `api-helpers.js:36-56` ‚Äî ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö user ‡πÉ‡∏ô DB ‡∏ó‡∏∏‡∏Å 5 ‡∏ô‡∏≤‡∏ó‡∏µ |
| Session destroy on logout | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `auth-service.js:134` ‚Äî `session.destroy()` |
| Session secret ‚â• 32 characters (production) | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `session.js:21-22` ‚Äî ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏ô production |
| ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô SESSION_SECRET ‡∏ó‡∏µ‡πà‡∏≠‡πà‡∏≠‡∏ô‡πÅ‡∏≠ | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `session.js:25` ‚Äî ‡∏ï‡∏£‡∏ß‡∏à pattern `test/dev/password` |
| **MFA (Multi-Factor Authentication)** | ‚ö†Ô∏è ‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô | ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ MFA ‚Äî ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏û‡∏¥‡πà‡∏° TOTP ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö admin |

---

## ‡∏´‡∏°‡∏ß‡∏î‡∏ó‡∏µ‡πà 2: ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á (Access Control)

| ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô |
|-----------|--------|---------|
| RBAC (Role-Based Access Control) | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `api-helpers.js:92-110` ‚Äî `requireAdmin()` ‡πÅ‡∏¢‡∏Å admin/user |
| ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏∏‡∏Å API route | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | ‡∏ó‡∏∏‡∏Å route ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å `requireAuth()` ‡∏Å‡πà‡∏≠‡∏ô‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ |
| Destructive operations (DELETE) ‡∏ï‡πâ‡∏≠‡∏á admin | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | shops/licenses/license-types ‡πÉ‡∏ä‡πâ `requireAdmin()` |
| ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô Horizontal Privilege Escalation | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö ownership/role ‡∏Å‡πà‡∏≠‡∏ô‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ |
| Sync role ‡πÄ‡∏°‡∏∑‡πà‡∏≠ admin ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `api-helpers.js:48-50` ‚Äî sync role ‡∏à‡∏≤‡∏Å DB ‡∏ó‡∏∏‡∏Å 5 ‡∏ô‡∏≤‡∏ó‡∏µ |
| ‡∏•‡∏ö session ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÄ‡∏°‡∏∑‡πà‡∏≠ user ‡∏ñ‡∏π‡∏Å‡∏•‡∏ö | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `api-helpers.js:42-45` ‚Äî destroy session ‡∏ñ‡πâ‡∏≤ user ‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô DB |

---

## ‡∏´‡∏°‡∏ß‡∏î‡∏ó‡∏µ‡πà 3: ‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô Injection (Injection Prevention)

### 3.1 SQL Injection

| ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô |
|-----------|--------|---------|
| Parameterized queries ‡∏ó‡∏∏‡∏Å query | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `db.js` ‚Äî ‡πÉ‡∏ä‡πâ `$1, $2...` ‡∏ú‡πà‡∏≤‡∏ô `@neondatabase/serverless` |
| Table name whitelist | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `db.js:81-93` ‚Äî `ALLOWED_TABLES` array |
| Column name validation | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `db.js:109-113` ‚Äî regex `/^[a-zA-Z_][a-zA-Z0-9_]*$/` |
| ‡πÑ‡∏°‡πà‡∏°‡∏µ dynamic SQL concatenation | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏∏‡∏Å route ‚Äî ‡πÉ‡∏ä‡πâ parameterized queries ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô |

### 3.2 XSS (Cross-Site Scripting)

| ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô |
|-----------|--------|---------|
| Input sanitization | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `security.js:30-44` ‚Äî `sanitizeString()` ‡∏•‡∏ö `<>`, event handlers, javascript: |
| HTML entity decode ‡∏Å‡πà‡∏≠‡∏ô sanitize | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `security.js:34-37` ‚Äî decode `&#x3c;`, `&#60;`, `\u003c` |
| CSP header | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `next.config.js:52-65` + `middleware.js:207-208` |
| React auto-escaping (frontend) | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | Next.js React JSX auto-escapes output by default |

### 3.3 CSRF (Cross-Site Request Forgery)

| ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô |
|-----------|--------|---------|
| SameSite cookie | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `session.js:56` ‚Äî `sameSite: 'strict'` |
| Origin/Referer validation | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `middleware.js:78-101` ‚Äî ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Origin/Referer ‡∏ó‡∏∏‡∏Å POST/PUT/DELETE |

### 3.4 CSV Injection

| ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô |
|-----------|--------|---------|
| Sanitize formula characters ‡πÉ‡∏ô CSV export | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `export/route.js:15-22` ‚Äî `sanitizeCsvValue()` prefix `'` ‡∏´‡∏ô‡πâ‡∏≤ `=+\-@\t\r` |

---

## ‡∏´‡∏°‡∏ß‡∏î‡∏ó‡∏µ‡πà 4: ‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏±‡πà‡∏ß‡πÑ‡∏´‡∏• (Data Protection)

### 4.1 ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏™‡πà‡∏á (Transport Security)

| ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô |
|-----------|--------|---------|
| HTTPS ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö (HSTS) | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `middleware.js:188` + `next.config.js:70` ‚Äî `max-age=63072000; includeSubDomains; preload` |
| upgrade-insecure-requests | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `next.config.js:64` ‚Äî ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô CSP |
| Secure cookie flag | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `session.js:52` ‚Äî `secure: true` ‡πÉ‡∏ô production |

### 4.2 ‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• (PDPA Compliance)

| ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô |
|-----------|--------|---------|
| ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™ (‡πÑ‡∏°‡πà‡πÄ‡∏Å‡πá‡∏ö plaintext) | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | bcrypt hash ‡∏î‡πâ‡∏ß‡∏¢ 12 rounds |
| ‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÉ‡∏ô API response | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `auth-service.js:61` ‚Äî `{ password: _, ...userWithoutPassword }` |
| Audit log ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `activityLogger.js` ‚Äî ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å CRUD ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î + IP + User Agent |
| **Privacy Policy / Cookie Consent** | ‚ö†Ô∏è ‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô | ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡∏ô‡πâ‡∏≤ Privacy Policy ‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞ ‚Äî ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö PDPA compliance |

### 4.3 ‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏±‡πà‡∏ß‡πÑ‡∏´‡∏•‡∏ó‡∏≤‡∏á Error

| ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô |
|-----------|--------|---------|
| Production error masking | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `api-helpers.js:164-170` ‚Äî `safeErrorMessage()` ‡∏ã‡πà‡∏≠‡∏ô internal errors |
| DB error sanitization | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `db.js:34-47` ‚Äî `sanitizeErrorMessage()` |
| console.log ‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡πÉ‡∏ô production | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `next.config.js:18` ‚Äî `removeConsole: true` |

---

## ‡∏´‡∏°‡∏ß‡∏î‡∏ó‡∏µ‡πà 5: Security Headers & Transport Security

| Header | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏Ñ‡πà‡∏≤ | ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô |
|--------|--------|-----|---------|
| **Strict-Transport-Security** | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `max-age=63072000; includeSubDomains; preload` | `middleware.js:188` |
| **X-Frame-Options** | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `DENY` | `middleware.js:179` |
| **X-Content-Type-Options** | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `nosniff` | `middleware.js:178` |
| **Content-Security-Policy** | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | Restrictive CSP ‡∏ó‡∏µ‡πà‡∏°‡∏µ `default-src 'self'`, `object-src 'none'`, `frame-ancestors 'none'` | `next.config.js:52-65` |
| **Referrer-Policy** | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `strict-origin-when-cross-origin` | `middleware.js:180` |
| **Permissions-Policy** | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `camera=(), microphone=(), geolocation=(), payment=(), usb=()` | `middleware.js:181` |
| **Cross-Origin-Opener-Policy** | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `same-origin` | `middleware.js:217` |
| **Cross-Origin-Resource-Policy** | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `same-origin` | `middleware.js:218` |
| **Cache-Control (API)** | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `no-store, no-cache, must-revalidate` | `middleware.js:182-184` |
| **X-Powered-By ‡∏ñ‡∏π‡∏Å‡∏•‡∏ö** | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | ‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô fingerprinting | `middleware.js:195` |

---

## ‡∏´‡∏°‡∏ß‡∏î‡∏ó‡∏µ‡πà 6: ‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö (Logging & Monitoring)

| ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô |
|-----------|--------|---------|
| ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Login/Logout | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `auth-service.js:108-113, 126-131` |
| ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å CRUD operations | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | ‡∏ó‡∏∏‡∏Å API route ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å `logActivity()` |
| ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Export operations | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `export/route.js:248-255` |
| ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å IP Address + User Agent | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `activityLogger.js:22-25` |
| Automatic log cleanup (30 ‡∏ß‡∏±‡∏ô) | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `activityLogger.js:76-83` ‚Äî ‡∏•‡∏ö log ‡πÄ‡∏Å‡πà‡∏≤‡∏Å‡∏ß‡πà‡∏≤ 30 ‡∏ß‡∏±‡∏ô |

---

## ‡∏´‡∏°‡∏ß‡∏î‡∏ó‡∏µ‡πà 7: ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î (Error Handling)

| ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô |
|-----------|--------|---------|
| ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢ Stack trace ‡πÉ‡∏ô production | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `safeErrorMessage()` + `removeConsole` |
| ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢ DB schema ‡πÉ‡∏ô error | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `db.js:34-47` ‚Äî sanitize DB errors |
| ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢ internal paths | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | error response ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô |
| Query timeout protection | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `db.js:29,52-57` ‚Äî 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ timeout |

---

## ‡∏´‡∏°‡∏ß‡∏î‡∏ó‡∏µ‡πà 8: ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Configuration & Infrastructure

| ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô |
|-----------|--------|---------|
| Environment variables ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö secrets | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `.env.local` ‚Äî `SESSION_SECRET`, `DATABASE_URL` |
| ‡πÑ‡∏°‡πà hardcode credentials ‡πÉ‡∏ô source code | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á codebase ‚Äî ‡πÑ‡∏°‡πà‡∏û‡∏ö hardcoded secrets |
| Body size limit (‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô DoS) | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `middleware.js:67-75` ‚Äî 100KB limit |
| WAF (Web Application Firewall) | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | `middleware.js:30-41` ‚Äî ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö SQLi, XSS, Path Traversal patterns + recursive decode |
| **Rate Limiting persistence** | ‚ö†Ô∏è ‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô | ‡∏°‡∏µ Redis (Upstash) + in-memory fallback ‚Äî ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Redis ‡∏à‡∏∞‡πÉ‡∏ä‡πâ in-memory ‡∏ã‡∏∂‡πà‡∏á‡πÑ‡∏°‡πà persist ‡∏Ç‡πâ‡∏≤‡∏° cold starts |

---

## üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

### ‚úÖ ‡∏à‡∏∏‡∏î‡πÅ‡∏Ç‡πá‡∏á (Strengths)
1. **Defense-in-Depth** ‚Äî ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡∏ä‡∏±‡πâ‡∏ô (WAF ‚Üí Rate Limit ‚Üí Auth ‚Üí Input Validation ‚Üí Parameterized SQL)
2. **Session Security** ‚Äî iron-session encryption + HttpOnly + Secure + SameSite Strict + TTL + DB re-validation
3. **Password Security** ‚Äî bcrypt 12 rounds + strong policy + timing-safe comparison + account lockout
4. **Security Headers** ‚Äî ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô (HSTS preload, CSP, COOP, CORP, X-Frame-Options DENY)
5. **Audit Trail** ‚Äî ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å activity ‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏£‡πâ‡∏≠‡∏° IP, User Agent, timestamp
6. **CSRF Protection** ‚Äî SameSite Strict + Origin/Referer validation ‡πÉ‡∏ô middleware
7. **Tool Blocking** ‚Äî ‡∏ö‡∏•‡πá‡∏≠‡∏Ñ scanner/attack tools (sqlmap, nikto, nuclei, etc.) ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà middleware

### ‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (Recommendations)

| ‡∏•‡∏≥‡∏î‡∏±‡∏ö | ‡∏Ç‡πâ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ | ‡∏£‡∏∞‡∏î‡∏±‡∏ö | ‡∏´‡∏°‡∏ß‡∏î |
|-------|-----------|-------|------|
| 1 | ‡πÄ‡∏û‡∏¥‡πà‡∏° Multi-Factor Authentication (TOTP) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö admin | ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á | 1 |
| 2 | ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏ô‡πâ‡∏≤ Privacy Policy ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö PDPA compliance | ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á | 4 |
| 3 | ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Upstash Redis ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Rate Limiting ‡∏ó‡∏µ‡πà persist ‡∏Ç‡πâ‡∏≤‡∏° instances | ‡∏ï‡πà‡∏≥ | 8 |

---

## üìã Checklist ‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô OWASP Top 10:2021

| # | OWASP Top 10 | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏°‡∏≤‡∏ï‡∏£‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ |
|---|-------------|--------|-------------|
| A01 | Broken Access Control | ‚úÖ ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß | RBAC, requireAuth/requireAdmin, session validation, CSRF protection |
| A02 | Cryptographic Failures | ‚úÖ ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß | bcrypt 12 rounds, HTTPS/HSTS, iron-session AES-256-GCM |
| A03 | Injection | ‚úÖ ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß | Parameterized SQL, input sanitization, WAF, CSP |
| A04 | Insecure Design | ‚úÖ ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß | Defense-in-depth, principle of least privilege |
| A05 | Security Misconfiguration | ‚úÖ ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß | Security headers, error masking, console removal |
| A06 | Vulnerable Components | ‚úÖ ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß | ‡πÉ‡∏ä‡πâ packages ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô, tree-shaking |
| A07 | Auth Failures | ‚úÖ ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß | Strong password, account lockout, session TTL, timing-safe |
| A08 | Data Integrity Failures | ‚úÖ ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß | Input validation, enum whitelist, table/column whitelist |
| A09 | Logging Failures | ‚úÖ ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß | Comprehensive audit logging ‡∏ó‡∏∏‡∏Å operation |
| A10 | SSRF | ‚úÖ ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß | ‡πÑ‡∏°‡πà‡∏°‡∏µ user-supplied URL fetching, connect-src restricted |

---

## üìã Checklist ‡∏ï‡∏≤‡∏° ‡∏û.‡∏£.‡∏ö. ‡πÑ‡∏ã‡πÄ‡∏ö‡∏≠‡∏£‡πå & PDPA

| ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ |
|-----------|--------|----------|
| ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• (PDPA ‡∏°.37) | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô bcrypt, session encrypted, HTTPS |
| ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á (‡πÑ‡∏ã‡πÄ‡∏ö‡∏≠‡∏£‡πå ‡∏°.56) | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | RBAC + Auth ‡∏ó‡∏∏‡∏Å route |
| ‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Log (‡πÑ‡∏ã‡πÄ‡∏ö‡∏≠‡∏£‡πå ‡∏°.57) | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | Audit log + IP + User Agent + 30 ‡∏ß‡∏±‡∏ô retention |
| ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏•‡∏∞‡πÄ‡∏°‡∏¥‡∏î (PDPA ‡∏°.37(4)) | ‚ÑπÔ∏è N/A | ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ procedure ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏£‡∏∞‡∏î‡∏±‡∏ö code) |
| ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏Ç‡∏≠‡∏á‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (PDPA ‡∏°.30-36) | ‚ö†Ô∏è ‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô | ‡∏°‡∏µ CRUD ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ self-service portal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• |

---

## üìà ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏£‡∏∏‡∏õ

| ‡πÄ‡∏Å‡∏ì‡∏ë‡πå | ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ |
|-------|--------|----------|
| ‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏™‡∏π‡∏à‡∏ô‡πå‡∏ï‡∏±‡∏ß‡∏ï‡∏ô & Session | 9/10 | -1 ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ MFA |
| ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á | 10/10 | ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô |
| ‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô Injection | 10/10 | ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô |
| ‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏±‡πà‡∏ß‡πÑ‡∏´‡∏• | 9/10 | -1 ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ Privacy Policy page |
| Security Headers | 10/10 | ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô |
| Logging & Monitoring | 10/10 | ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô |
| Error Handling | 10/10 | ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô |
| Configuration & Infra | 9/10 | -1 Rate limiting ‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡∏±‡∏ö Redis config |
| **‡∏£‡∏ß‡∏°** | **87/90 (96.7%)** | **‡∏£‡∏∞‡∏î‡∏±‡∏ö: ‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°** |

### ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô
- **90-100%** ‚Äî ‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏° (Excellent) ‚Üê **‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏µ‡πâ**
- **80-89%** ‚Äî ‡∏î‡∏µ‡∏°‡∏≤‡∏Å (Very Good)
- **70-79%** ‚Äî ‡∏î‡∏µ (Good)
- **60-69%** ‚Äî ‡∏û‡∏≠‡πÉ‡∏ä‡πâ (Fair)
- **< 60%** ‚Äî ‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á (Needs Improvement)

---

*‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢ Cascade AI ‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏ó‡∏µ‡πà‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ (‡∏™‡∏û‡∏ò‡∏≠.) ‡πÅ‡∏•‡∏∞ OWASP Top 10:2021*  
*‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: 16 ‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå 2569*
